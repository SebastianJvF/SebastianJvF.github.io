<!doctype html>
<html>
<head>

	<title>Web app for rapid prototyping of interactive smartphone cases</title>
	
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="css/layout.css"  media="all">
	
	<script src="js/fabric/fabric.js" type="text/javascript"></script>
	<script src="js/jquery-1.11.3.js" type="text/javascript"></script>
	
	<script type="text/javascript">
	/** MENU **/
	/* Menu toggles, Errors */
	$(document).ready(function () {
		/* Hide all option panels */
		$("#info-message").hide();
		$("nav div.options").hide();   
	  
	  	/* Change all the description divs into links */
		$("nav div.description").each(function () {
			var contentDescription = $(this).text()
			$(this).replaceWith('<a href="" title="Click to view the sub menu" class="description">' + contentDescription + '<\/a>') ;
		}); 
		
		/* Change the onclick function of the created links*/
		$("nav a.description").click( function () {
				
			/* If the menue is open, close it; Remark: next takes the next element of the same parent of the given element */
			if ($(this).next("div.options:visible").length != 0) {
				$(this).next("div.options").slideUp("normal");
			} else { /* Otherwise open it */
				/* Close all other menues */
				$("nav div.options").slideUp("normal");
				/* Open the next div.options we can find */
				$(this).next("div.options").slideDown("normal");
			}

			/* So that the browser does not try to open the link */
		    return false;
		});
	});
	
	/* Show error messages if needed */
	var errorMessageRed = '#FF6060';
	var errorMessageGreen = '#6088FF';
	
	function errorMessage(message, backgroundColor) {
		$("#info-message").html(message);
		$("#info-message").css("background-color", backgroundColor);
		$("#info-message").show().delay(10000).fadeOut();
		$("#info-message").slideUp("normal");
	}
	
	/** APPLICATION **/
	/* Phone model */
	var phoneModel;
	
	/* Make the user choose a phone model (disabled), show message */
	$(document).ready(function() {
		// $('#canvas').hide();
		$('#phone-model').change(function () {
		    if($(this).val() != '') {
		    	phoneModel = $(this).val();
		    	errorMessage('Phone model chosen:<br>' +  $("#phone-model option:selected").text(), errorMessageGreen);
		    	// $('#canvas').show();
		    } else {
		    	// $('#canvas').hide();
				phoneModel = '';
				errorMessage('Please choose a phone model!', errorMessageRed);
		    }
		})
	});
	</script>

</head>
<body>
	<div id="info-message">
	Please activate Javascript to use this application.
	</div>

	<div id="wrap">
		<nav>
			<div class="information">
			Please click on the menu headers below
			to view available configuration options.
			</div>
			
			<h1>Phone model</h1>
			<div class="description">Choose one of the available phone models below</div>
			<div class="options">
				<form id="application">
				<select id="phone-model">
				<option value="">Please choose...</option>
				<option value="iphone-5">iPhone 5</option>
				</select>
				</form>
			</div>	
			
			<h1>Push buttons</h1>
			<div class="description">Buttons that spring back to their usual, unpushed state</div>
			<div class="options">
				<ul>
				<li><a href="#"><span></span>Label</a></li>
				<li><a href="#"><span></span>Label</a></li>
				<li><a href="#"><span></span>Label</a></li>
				<li><a href="#"><span></span>Label</a></li>
				<li><a href="#"><span></span>Label</a></li>
				<li></li>
				</ul>
				<span class="clear"></span>
			</div>
			
			<h1>Knobs</h1>
			<div class="description">Rotary controls that can be turned to indicate one of the available state positions</div>
			<div class="options">Options panel</div>
			
			<h1>Sliders</h1>
			<div class="description">Control element to set a value by moving an indicator</div>
			<div class="options">Options panel</div>
		</nav>
		
		<div id="two-d-preview">
			<div class="information">
			This is a <span class="bold">2D representation</span> of the phone case.<br>
			Please drag controls from the menu onto the panel.
			</div>
	    	<canvas id="canvas" width="570" height="500"></canvas>
	    	
	    	<canvas id="canvas1" style="width:300px;height:300px;"></canvas>
	    	<canvas id="canvas2" style="width:300px;height:300px;"></canvas>
	    </div>
	    
	    <script>
		var canvas = new fabric.Canvas('canvas');
	
		/** 2D PHONE MODEL **/
		var modelStrokeWidth = 2;
		var modelColor = '#ffffff';
		var modelStrokeColor = '#c3bfbf';
		
		var middleRect = new fabric.Rect({
				top : 110,
				left : 185,
				width : 200,
				height : 280,
				fill : modelColor,
				strokeWidth : modelStrokeWidth,
				stroke: modelStrokeColor
		});
		
		var leftRect = new fabric.Rect({
				top : 110,
				left : 115,
				width : 50,
				height : 280,
				fill : modelColor,
				strokeWidth : modelStrokeWidth,
				stroke: modelStrokeColor
		});
		
		var rightRect = new fabric.Rect({
				top : 110,
				left : 405,
				width : 50,
				height : 280,
				fill : modelColor,
				strokeWidth : modelStrokeWidth,
				stroke: modelStrokeColor
		});
		
		var topRect = new fabric.Rect({
				top : 40,
				left : 185,
				width : 200,
				height : 50,
				fill : modelColor,
				strokeWidth : modelStrokeWidth,
				stroke: modelStrokeColor
		});
		
		var bottomRect = new fabric.Rect({
				top : 410,
				left : 185,
				width : 200,
				height : 50,
				fill : modelColor,
				strokeWidth : modelStrokeWidth,
				stroke: modelStrokeColor
		});
	
		canvas.add(middleRect);
		canvas.add(leftRect);
		canvas.add(rightRect);
		canvas.add(topRect);
		canvas.add(bottomRect);
		
		$(document).ready(function() {
		    
		    var canvases = {
		        canvas1 : new fabric.Canvas('canvas1', {backgroundColor: 'red'}),
		        canvas2 : new fabric.Canvas('canvas2', {backgroundColor: 'blue'})
		    };
		                  
		    var text = new fabric.Text('Hello world!', { left: 0,
		            top : 0,
		            fontSize: 30,
		            fontFamily: 'Arial',
		            fill: 'black',
		            textAlign: 'left',
		            hasControls: true,
		            lockUniScaling: true,
		            borderColor: '#fff',
		            cornerColor: '#fff' 
		    });
		    
		    var activeObject, initialCanvas;
		    
		    canvases.canvas1.add(text);
		    
		    canvases.canvas1.on('mouse:down', function() {
		            activeObject  = text;
		            initialCanvas = this.lowerCanvasEl.id;
		    });
		    
		    $(document).on('mouseup', function(evt) {
		            canvasId = $(evt.target).siblings().attr('id');
		                canvas.add(activeObject);
		                if(canvasId !== initialCanvas) {
		                	activeObject.setTop(0);
		                	activeObject.setLeft(0);
		                	canvas.renderAll();
		                	// these two lines will make the original object snap back to whatever position you define
		                	canvases[initialCanvas].getActiveObject().setTop(0);
		                	canvases[initialCanvas].getActiveObject().setLeft(0);
		                }
		        initialCanvas = '';              
		    });    
		});
		
		/* Make mock-up unselectable */
		for(var i = 0; i < 6; i++) {
			canvas.item(i).selectable = false;
		}
	    </script>
		
		<div id="three-d-panel">
			<div class="information">This is a <span class="bold">3D preview</span> of the case.<br> Turn it by dragging around.</div>
			<div id="three-d-preview"></div>
			<a href="#" title="Download 3D model(s)">Download 3D model(s)</a>
		</div>
		
		<span class="clear"></span>
	</div>

</body>
</html>